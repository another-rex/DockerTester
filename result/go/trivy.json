{
  "SchemaVersion": 2,
  "CreatedAt": "2024-02-04T15:15:33.146293858Z",
  "ArtifactName": "docker-scanning-test-go",
  "ArtifactType": "container_image",
  "Metadata": {
    "OS": {
      "Family": "debian",
      "Name": "trixie/sid"
    },
    "ImageID": "sha256:49ddc6ef61a1e7b3f1b85698d63bf78d3852858a736331911af29c5ed9e5bb69",
    "DiffIDs": [
      "sha256:941bb154709688a41c743238a1dca0e0d1d28a247b89567cb2c18436271ebe1e",
      "sha256:5565b0e6eea6ac0d3cc3e8ba1805d58b4948eabd799d5c2c1bb307b4e5aaa067",
      "sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef",
      "sha256:a06dd2645ed66226a66044c37bd762db150b7d8a5985945665dc794f8a40c5d5",
      "sha256:2193e9a42c8f852087c338618eddf6e1e514dfa74252a9e8f806578a2b0b457c",
      "sha256:fa062fbee8551ef0bb29bbd95e7064c9071a225f7ebc4e4703e7343f7575253a",
      "sha256:dd905273ca68f8c8d9288b2d7f8a2759e2a5ca224b516df43dedfe24a019464f",
      "sha256:d09bd5c01a96e11b3c9f00435a23736bc259d71257256508d9452872d0975a1a",
      "sha256:01c7128819d260561e7e975d37edc77e72b304a89c8639cf2d9fcda4358f7333"
    ],
    "RepoTags": [
      "docker-scanning-test-go:latest"
    ],
    "ImageConfig": {
      "architecture": "amd64",
      "created": "2024-02-02T13:18:36.119682462Z",
      "history": [
        {
          "created": "2024-01-31T22:37:49Z",
          "created_by": "/bin/sh -c #(nop) ADD file:78f5e584e45cc3316db2f908517a75399e41b10f9055de8915646c20535298fc in / "
        },
        {
          "created": "2024-01-31T22:37:49Z",
          "created_by": "/bin/sh -c #(nop)  CMD [\"bash\"]",
          "empty_layer": true
        },
        {
          "created": "2024-02-01T02:58:24Z",
          "created_by": "RUN /bin/sh -c mkdir /src # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-01T02:58:24Z",
          "created_by": "WORKDIR /src",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:17:13Z",
          "created_by": "COPY base/ ./base # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:17:58Z",
          "created_by": "RUN /bin/sh -c apt-get update \u0026\u0026 apt-get upgrade -y \u0026\u0026     apt-get install -y     golang     git # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:18:26Z",
          "created_by": "RUN /bin/sh -c cd ./base \u0026\u0026 go build -o main . # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:18:27Z",
          "created_by": "RUN /bin/sh -c mkdir ./final # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:18:27Z",
          "created_by": "COPY final/ ./final # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:18:36Z",
          "created_by": "RUN /bin/sh -c cd ./final \u0026\u0026 go build -o main . # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2024-02-02T13:18:36Z",
          "created_by": "ENTRYPOINT [\"./final/main\"]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        }
      ],
      "os": "linux",
      "rootfs": {
        "type": "layers",
        "diff_ids": [
          "sha256:941bb154709688a41c743238a1dca0e0d1d28a247b89567cb2c18436271ebe1e",
          "sha256:5565b0e6eea6ac0d3cc3e8ba1805d58b4948eabd799d5c2c1bb307b4e5aaa067",
          "sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef",
          "sha256:a06dd2645ed66226a66044c37bd762db150b7d8a5985945665dc794f8a40c5d5",
          "sha256:2193e9a42c8f852087c338618eddf6e1e514dfa74252a9e8f806578a2b0b457c",
          "sha256:fa062fbee8551ef0bb29bbd95e7064c9071a225f7ebc4e4703e7343f7575253a",
          "sha256:dd905273ca68f8c8d9288b2d7f8a2759e2a5ca224b516df43dedfe24a019464f",
          "sha256:d09bd5c01a96e11b3c9f00435a23736bc259d71257256508d9452872d0975a1a",
          "sha256:01c7128819d260561e7e975d37edc77e72b304a89c8639cf2d9fcda4358f7333"
        ]
      },
      "config": {
        "Entrypoint": [
          "./final/main"
        ],
        "Env": [
          "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
        ],
        "WorkingDir": "/src"
      }
    }
  },
  "Results": [
    {
      "Target": "docker-scanning-test-go (debian trixie/sid)",
      "Class": "os-pkgs",
      "Type": "debian"
    },
    {
      "Target": "root/go/pkg/mod/github.com/google/osv-scanner@v1.6.2/cmd/osv-scanner/fixtures/locks-insecure/composer.lock",
      "Class": "lang-pkgs",
      "Type": "composer",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2021-32708",
          "PkgID": "league/flysystem@1.0.8",
          "PkgName": "league/flysystem",
          "InstalledVersion": "1.0.8",
          "FixedVersion": "1.1.4, 2.1.1",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:fa062fbee8551ef0bb29bbd95e7064c9071a225f7ebc4e4703e7343f7575253a"
          },
          "SeveritySource": "nvd",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2021-32708",
          "DataSource": {
            "ID": "php-security-advisories",
            "Name": "PHP Security Advisories Database",
            "URL": "https://github.com/FriendsOfPHP/security-advisories"
          },
          "Title": "Flysystem is an open source file storage library for PHP. The whitespa ...",
          "Description": "Flysystem is an open source file storage library for PHP. The whitespace normalisation using in 1.x and 2.x removes any unicode whitespace. Under certain specific conditions this could potentially allow a malicious user to execute code remotely. The conditions are: A user is allowed to supply the path or filename of an uploaded file, the supplied path or filename is not checked against unicode chars, the supplied pathname checked against an extension deny-list, not an allow-list, the supplied path or filename contains a unicode whitespace char in the extension, the uploaded file is stored in a directory that allows PHP code to be executed. Given these conditions are met a user can upload and execute arbitrary code on the system under attack. The unicode whitespace removal has been replaced with a rejection (exception). For 1.x users, upgrade to 1.1.4. For 2.x users, upgrade to 2.1.1.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-367"
          ],
          "VendorSeverity": {
            "ghsa": 4,
            "nvd": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 9.8
            },
            "nvd": {
              "V2Vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C",
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V2Score": 9.3,
              "V3Score": 8.1
            }
          },
          "References": [
            "https://github.com/thephpleague/flysystem",
            "https://github.com/thephpleague/flysystem/commit/a3c694de9f7e844b76f9d1b61296ebf6e8d89d74",
            "https://github.com/thephpleague/flysystem/commit/f3ad69181b8afed2c9edf7be5a2918144ff4ea32",
            "https://github.com/thephpleague/flysystem/security/advisories/GHSA-9f46-5r25-5wfm",
            "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NWPTENBYKI2IG47GI4DHAACLNRLTWUR5/",
            "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RNZSWK4GOMJOOHKLZEOE5AQSLC4DNCRZ/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NWPTENBYKI2IG47GI4DHAACLNRLTWUR5/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RNZSWK4GOMJOOHKLZEOE5AQSLC4DNCRZ/",
            "https://nvd.nist.gov/vuln/detail/CVE-2021-32708",
            "https://packagist.org/packages/league/flysystem"
          ],
          "PublishedDate": "2021-06-24T17:15:08.263Z",
          "LastModifiedDate": "2023-11-07T03:35:24.547Z"
        }
      ]
    },
    {
      "Target": "src/base/main",
      "Class": "lang-pkgs",
      "Type": "gobinary",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2022-31022",
          "PkgName": "github.com/blevesearch/bleve",
          "InstalledVersion": "v1.0.14",
          "Status": "affected",
          "Layer": {
            "DiffID": "sha256:fa062fbee8551ef0bb29bbd95e7064c9071a225f7ebc4e4703e7343f7575253a"
          },
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2022-31022",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory Go",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"
          },
          "Title": "Bleve is a text indexing library for go. Bleve includes HTTP utilities ...",
          "Description": "Bleve is a text indexing library for go. Bleve includes HTTP utilities under bleve/http package, that are used by its sample application. These HTTP methods pave way for exploitation of a node’s filesystem where the bleve index resides, if the user has used bleve’s own HTTP (bleve/http) handlers for exposing the access to the indexes. For instance, the CreateIndexHandler (`http/index_create.go`) and DeleteIndexHandler (`http/index_delete.go`) enable an attacker to create a bleve index (directory structure) anywhere where the user running the server has the write permissions and to delete recursively any directory owned by the same user account. Users who have used the bleve/http package for exposing access to bleve index without the explicit handling for the Role Based Access Controls(RBAC) of the index assets would be impacted by this issue. There is no patch for this issue because the http package is purely intended to be used for demonstration purposes. Bleve was never designed handle the RBACs, nor it was ever advertised to be used in that way. The collaborators of this project have decided to stay away from adding any authentication or authorization to bleve project at the moment. The bleve/http package is mainly for demonstration purposes and it lacks exhaustive validation of the user inputs as well as any authentication and authorization measures. It is recommended to not use bleve/http in production use cases.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-288",
            "CWE-306"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
              "V3Score": 5.5
            },
            "nvd": {
              "V2Vector": "AV:L/AC:L/Au:N/C:N/I:P/A:N",
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
              "V2Score": 2.1,
              "V3Score": 5.5
            }
          },
          "References": [
            "github.com/blevesearch/bleve",
            "https://github.com/blevesearch/bleve/commit/1c7509d6a17d36f265c90b4e8f4e3a3182fe79ff",
            "https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w",
            "https://nvd.nist.gov/vuln/detail/CVE-2022-31022",
            "https://pkg.go.dev/vuln/GO-2022-0470"
          ],
          "PublishedDate": "2022-06-01T20:15:08.037Z",
          "LastModifiedDate": "2022-06-09T14:13:24.47Z"
        }
      ]
    },
    {
      "Target": "src/final/main",
      "Class": "lang-pkgs",
      "Type": "gobinary",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2024-23840",
          "PkgName": "github.com/goreleaser/goreleaser",
          "InstalledVersion": "v1.23.0",
          "FixedVersion": "1.24.0",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:01c7128819d260561e7e975d37edc77e72b304a89c8639cf2d9fcda4358f7333"
          },
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-23840",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory Go",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"
          },
          "Title": "goreleaser: goreleaser release --debug shows secrets",
          "Description": "GoReleaser builds Go binaries for several platforms, creates a GitHub release and then pushes a Homebrew formula to a tap repository. `goreleaser release --debug` log shows secret values used in the in the custom publisher. This vulnerability is fixed in 1.24.0.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-532"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-23840",
            "https://github.com/goreleaser/goreleaser",
            "https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
            "https://github.com/goreleaser/goreleaser/security/advisories/GHSA-h3q2-8whx-c29h",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-23840",
            "https://www.cve.org/CVERecord?id=CVE-2024-23840"
          ],
          "PublishedDate": "2024-01-30T17:15:11.81Z",
          "LastModifiedDate": "2024-01-30T20:48:58.267Z"
        }
      ]
    }
  ]
}
